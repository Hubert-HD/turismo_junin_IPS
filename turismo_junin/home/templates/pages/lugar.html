{% extends 'base.html' %}
{% load static %}

{% block title %}{{ nombre }}{% endblock %}
{% block content %}
<div class="slide">
  <img class="slide__fondo" src="{{ recurso.image_URL }}" alt="{{ recurso.nombre }}">
  <h2 class="slide__titulo">{{ recurso.nombre }}</h2>
  <h3 class="slide__subtitulo">{{ recurso.subtitulo }}</h3>
  <div class="slide__datos">
    <div class="slide__datos__corazon corazon {% if recurso.marcado %} corazon--active {% else %} corazon--desactive {% endif %}">
      <span class="corazon__icon" onclick="addFavoritos(event, '{{ recurso.nombre }}')"><i class="fas fa-heart"></i><i class="far fa-heart"></i></span>
      <span class="corazon__numero">{{ recurso.corazones }}</span>
    </div>
    <div class="slide__datos__ubicacion">
      <span><i class="fas fa-map-marker-alt"></i></span>
      <span>{{ recurso.provincia }}</span>
      <span class="slide__datos__ubicacion__circulo"><i class="fas fa-circle"></i></span>
      <span>{{ recurso.distrito }}</span>
    </div>
  </div>
</div>

<div class="etiqueta-main">
  <span class="etiqueta-main__icono"><i class="fas fa-tag"></i></span>
  <span class="etiqueta-main__clase">{{ recurso.categoria }}</span>
</div>


<p class="parrafo">{{ recurso.descripcion }}</p>

<div class="mapa-container">
  <div id="map" class="map">
  </div>
</div>

<h4 class="recomendados__titulo">Recomendados para ti</h4>
<div class="recomendados">
  <span class="recomendados__button--izquierda"><i class="fas fa-chevron-left"></i></span>
  <div class="recomendados__galeria">
    {% for card in recomendados %}
      <div class="card">
        <div class="card__imagen">
          <img class="card__imagen__img" src="{{ card.image }}" alt="{{ card.nombre }}">
          <h5 class="card__imagen__titulo">{{ card.nombre }}</h5>
          <p class="card__imagen__lugar">{{ card.provincia }}</p>
        </div>
        <div class="card__descripcion">
          <div class="etiqueta">
            <span class="etiqueta__icono"><i class="fas fa-tag"></i></span>
            <span class="etiqueta__clase">{{ card.categoria }}</span>
          </div>
            <div class="corazon {% if card.corazon.marcado %} corazon--active {% else %} corazon--desactive {% endif %}">
            <span class="corazon__icon" onclick="addFavoritos(event, '{{ card.nombre }}')"><i class="fas fa-heart"></i><i class="far fa-heart"></i></span>
            <span class="corazon__numero">{{ card.corazon.contador }}</span>
          </div>
          <a class="flecha" href="/destinos/{{ card.nombre }}/"><i class="fas fa-arrow-right"></i></a>
        </div>
      </div>
    {% endfor %}
  </div>
  <span class="recomendados__button--derecha"><i class="fas fa-chevron-right"></i></span>
</div>

{% endblock %}
{% block scripts %}
<script>
  activarRecomendaciones();
  function iniciarMap(){
    let nombre = document.querySelector(".slide__titulo").innerHTML;
    fetch(`../../api/coordenadas?nombre=${nombre}`)
    .then(response => response.json())
    .then(data => {
      let coord = {lat: data.latitud, lng: data.longuitud};
      let map = new google.maps.Map(document.getElementById('map'), {
        zoom: 15,
        center: coord
      });
      let marker = new google.maps.Marker({
        position: coord,
        map: map,
        title: 'Mapa Cargado!'
      });
    });
  }
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBMk5chJWP3Ly5JpJkzWAfDn_x1a2je4no&callback=iniciarMap"></script>
{% endblock %}